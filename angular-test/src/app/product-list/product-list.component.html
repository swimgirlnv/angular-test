<div class="product-list-container">
  <div class="category-filter">
    <h3>Categories</h3>
    <div class="category-buttons">
      @for (category of categories; track category) {
        <button
          class="category-btn"
          [class.active]="selectedCategory === category"
          (click)="selectCategory(category)">
          {{ category }}
        </button>
      }
    </div>
  </div>

  <div class="products-grid">
    @for (product of filteredProducts; track product.id) {
      <div class="product-card" [class.out-of-stock]="!product.inStock">
        <div class="product-image">{{ product.image }}</div>

        <!-- Rewards Badge -->
        @if (currentUser) {
          <div class="rewards-badge">
            +{{ getPointsForProduct(product) }} pts
          </div>
        }

        <div class="product-info">
          <h3 class="product-name">{{ product.name }}</h3>
          <p class="product-description">{{ product.description }}</p>

          <!-- Price Information -->
          <div class="price-section">
            @if (currentUser && getDiscountedPrice(product) < product.price) {
              <div class="price-with-discount">
                <span class="original-price">${{ product.price.toFixed(2) }}</span>
                <span class="discounted-price">${{ getDiscountedPrice(product).toFixed(2) }}</span>
              </div>
              <div class="tier-savings">
                {{ currentUser.tier }} Member Saves: ${{ (product.price - getDiscountedPrice(product)).toFixed(2) }}
              </div>
            } @else {
              <span class="product-price">${{ product.price.toFixed(2) }}</span>
            }
          </div>

          <div class="product-footer">
            <button
              class="add-to-cart-btn"
              [disabled]="!product.inStock"
              (click)="addToCart(product)">
              {{ product.inStock ? 'Add to Cart' : 'Out of Stock' }}
            </button>
          </div>
        </div>
      </div>
    } @empty {
      <div class="no-products">
        <p>No products found in this category.</p>
      </div>
    }
  </div>
</div>
